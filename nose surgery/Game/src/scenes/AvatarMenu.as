package src.scenes {		import flash.display.MovieClip;	import src.game.SurgeryStep;	import flash.events.MouseEvent;	import src.game.SpilAPIManager;		public class AvatarMenu extends SurgeryStep {				private var m_sending:Boolean = false;		private var m_sendCode:int = -1;				public function AvatarMenu() 		{			stop();			avatarSelector.stop();			avatarSelector.avatar1.addEventListener(MouseEvent.CLICK, uploadAvatar1);			avatarSelector.avatar2.addEventListener(MouseEvent.CLICK, uploadAvatar2);			avatarSelector.avatar3.addEventListener(MouseEvent.CLICK, uploadAvatar3);			scheduleForUpdate();		}				private function uploadAvatar1(ev:MouseEvent)		{			m_sendCode = SpilAPIManager.sharedSpilAPI().sendAvatar(1);			m_sending = true;		}				private function uploadAvatar2(ev:MouseEvent)		{			m_sendCode = SpilAPIManager.sharedSpilAPI().sendAvatar(2);			m_sending = true;		}				private function uploadAvatar3(ev:MouseEvent)		{			m_sendCode = SpilAPIManager.sharedSpilAPI().sendAvatar(3);			m_sending = true;		}				override public function update()		{			if(m_sending)			{				// Wait for answer				avatarPlayAgain.visible = true;				avatarBack.visible = true;				if(m_sendCode == SpilAPIManager.SENDING)				{					avatarPlayAgain.visible = false;					avatarBack.visible = false;					if(SpilAPIManager.sharedSpilAPI().getLastAvatarStatus() == SpilAPIManager.SENT)					{						m_sendCode = SpilAPIManager.SENT;					}					else					{						if(currentFrame != 2)						{							avatarSelector.gotoAndStop(2);						}					}				}				else if(m_sendCode == SpilAPIManager.SENT)				{					avatarSelector.gotoAndStop(3);					m_sending = false;				}				else if(m_sendCode == SpilAPIManager.NOT_CONNECTED)				{					avatarSelector.gotoAndStop(6);					m_sending = false;				}				else if(m_sendCode == SpilAPIManager.ERROR)				{					avatarSelector.gotoAndStop(5);					m_sending = false;				}				else if(m_sendCode == SpilAPIManager.NOT_LOGGED)				{					avatarSelector.gotoAndStop(4);					m_sending = false;				}			}		}	}	}